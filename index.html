<!DOCTYPE html>
<html lang="ru">
    <head>
        
        <meta                                       charset="UTF-8">
        <meta   http-equiv="Permissions-Policy"     content="interest-cohort=()">
        <meta   http-equiv="Cache-Control"          content="no-cache">
        <meta   http-equiv="Pragma"                 content="no-cache">
        <meta   name="viewport"                     content="width=device-width, initial-scale=1">
        <meta   name="author"                       content="Plutonny">
        <meta   name="description"                  content="my cat ❤️">
        <meta   name="theme-color" id="theme-color" content="#000000">
        <title  id="title-page"                     >my cat ❤️</title>
        <link   rel="manifest"                      href="manifest.json">

        <script type="text/javascript">
            var gIc = () => { 
                let c = setInterval(() => {
                    try { document.getElementById('gIc').remove() } catch {}
                }, 100); 
            }
        </script>
        
        <style>
            @font-face {
                font-family: 'Material Symbols Rounded';
                font-style: normal;
                font-weight: 100 700;
                src: url(https://fonts.gstatic.com/s/materialsymbolsrounded/v74/sykg-zNym6YjUruM-QrEh7-nyTnjDwKNJ_190Fjzag.woff2) format('woff2');
            }

            .material-symbols-rounded {
                font-family: 'Material Symbols Rounded';
                font-weight: normal;
                font-style: normal;
                font-size: 24px;
                line-height: 1;
                letter-spacing: normal;
                text-transform: none;
                display: inline-block;
                white-space: nowrap;
                word-wrap: normal;
                direction: ltr;
                -webkit-font-feature-settings: 'liga';
                -webkit-font-smoothing: antialiased;
                font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 26;
            }
        </style>
        <link   rel="preconnect"                    href="https://fonts.googleapis.com">
        <link   rel="preconnect"                    href="https://fonts.gstatic.com" crossorigin>
        <link   rel="stylesheet"                    href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap">
        <link   rel="preload prefetch"              href="https://fonts.gstatic.com/s/materialsymbolsrounded/v74/sykg-zNym6YjUruM-QrEh7-nyTnjDwKNJ_190Fjzag.woff2" as="font" type="font/woff2" crossorigin onload="gIc()">

        <script type="text/javascript"              src="https://lib.plutonny.ru/plutonny.js/v1.1.js?cache=14.08.2023-v31-b30"></script>
        <link   rel="preload prefetch stylesheet"   href="static/main.css?cache=14.08.2023-v31-b30" as="style">
        
        <link   rel="icon"                          href="static/g-icon.png?cache=14.08.2023-v31-b30">
        <link   rel="apple-touch-icon"              href="pwa-icon-apple.png?cache=14.08.2023-v31-b30">

        <style id="theming"></style>
        <style id="modalWork"></style>
        <style id="fullModalWork"></style>
        <style id="modalWork2"></style>
        <style id="fullModalWork2"></style>
        <style id="gIc">
            .icoGo { opacity: 0; }
        </style>

        <!-- GLOBAL PREPARE -->
        <script type="text/javascript">
            "use strict";
            
            var siteVersion = '3.1'
            var siteBuild = '30'

            if (window.location.href.split('?')[1] == 'debug') plutonny.get.eruda()

            var DYNAMICTIME = new Date()

            var SEASON = '' // winter/spring/summer/autumn/newyear
            let dec10 = new Date(DYNAMICTIME.getFullYear(), 11, 10), jan20 = new Date(DYNAMICTIME.getFullYear(), 0, 20, 23, 59, 59, 999), dec31 = new Date(DYNAMICTIME.getFullYear(), 11, 31, 23, 59, 59, 999), jan01 = new Date(DYNAMICTIME.getFullYear(), 0, 1)
            if ((dec10 <= DYNAMICTIME && DYNAMICTIME <= dec31) || (jan01 <= DYNAMICTIME && DYNAMICTIME <= jan20)) { SEASON = 'newyear' }
            else { if ([11, 0, 1].includes(DYNAMICTIME.getMonth())) SEASON = 'winter'; if ([2, 3, 4].includes(DYNAMICTIME.getMonth())) SEASON = 'spring'; if ([5, 6, 7].includes(DYNAMICTIME.getMonth())) SEASON = 'summer'; if ([8, 9, 10].includes(DYNAMICTIME.getMonth())) SEASON = 'autumn' }

            var DAYTIMER = '' // night/sunrise/day/evening/sunset
            if ([19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6].includes(DYNAMICTIME.getHours())) DAYTIMER = 'night'; if ([7, 8, 9].includes(DYNAMICTIME.getHours())) DAYTIMER = 'sunrise'; if ([10, 11, 12, 13].includes(DYNAMICTIME.getHours())) DAYTIMER = 'day'; if ([14, 15, 16].includes(DYNAMICTIME.getHours())) DAYTIMER = 'evening';  if ([17, 18].includes(DYNAMICTIME.getHours())) DAYTIMER = 'sunset';

            if (localStorage.getItem('themeType') == null || localStorage.getItem('themeType') == '')
                { plutonny.console.warn('index.html -> preload checker', 'themeType is undefined, set to season'); localStorage.setItem('themeType', 'season') } 
                
            var UISEDT = ''
            if (localStorage.getItem('themeType') == 'season') UISEDT = SEASON
            if (localStorage.getItem('themeType') == 'time') UISEDT = DAYTIMER

            var NOBLUR = navigator.userAgent.includes('Windows') && navigator.userAgent.includes('Chrome')

            var monthList = ['января', 'февраля', 'марта', 'апреля', 'мая', 'июня', 'июля', 'августа', 'сентября', 'октября', 'ноября', 'декабря']

            document.addEventListener("click", (event) => {
                if (event.target.matches("#modal") && !event.target.closest(".max-modal")) { UX.closeModal('dialog') }
            }, false )
            document.addEventListener("click", (event) => {
                if (event.target.matches("#full-modal") && !event.target.closest(".full-max-modal")) { UX.closeModal('fullscreen') }
            }, false )
        </script>

        <!-- UX -->
        <script type="text/javascript">
            var ND = null
            var CE = null
            var GP = null
            var AW = null
            var AD = null
            var AH = null
            var AM = null
            var AS = null
            var UX = {
                datePrepare: (date) => {
                    let d1, d2
                    if (date < DYNAMICTIME) { 
                        d1 = new Date(new Date(DYNAMICTIME.getFullYear(), date.getMonth(), date.getDate(), date.getHours(), date.getMinutes(), date.getSeconds()))
                        d2 = new Date(new Date(DYNAMICTIME.getFullYear() + 1, date.getMonth(), date.getDate(), date.getHours(), date.getMinutes(), date.getSeconds()))
                    } else {
                        d1 = new Date(new Date(DYNAMICTIME.getFullYear() - 1, date.getMonth(), date.getDate(), date.getHours(), date.getMinutes(), date.getSeconds()))  
                        d2 = new Date(new Date(DYNAMICTIME.getFullYear(), date.getMonth(), date.getDate(), date.getHours(), date.getMinutes(), date.getSeconds()))
                    } return [d1, d2]
                },
                dateThisYear: (date, time) => {
                    let cdd
                    try {
                        cdd = new Date(DYNAMICTIME.getFullYear(), date.split('-')[0] - 1, date.split('-')[1], time.split(':')[0], time.split(':')[1])
                    } catch {
                        cdd = new Date(DYNAMICTIME.getFullYear(), date.split('-')[0] - 1, date.split('-')[1], 0, 0, 0)
                    }
                    return cdd
                },
                theme: {
                    UIlight: `
                        --back-page:          #f5f5f5  ;
                        --text-color:         #151515  ;
                        --text-color-active:  #202020  ;
                        --bg-color:           var(--back-page);
                        --bg-modal-color:     #e9e9e9${NOBLUR ? '' : 'cc'};
                        --con-color:          #dedede${NOBLUR ? '' : 'cc'};
                        --con-color-hover:    #d0d0d0${NOBLUR ? '' : 'cc'};
                        --con-color-active:   #cacaca${NOBLUR ? '' : 'cc'};
                        --con-alt-color:      #abababcc;
                        --line-general-color: #c0c0c040;
                        --icon-color:         #00000040;

                        --UI-icon-neutral:    #707070  ;
                        --UI-icon-neutral-op: #70707040;
                        --UI-icon-blue:       #0000ff  ;
                        --UI-icon-blue-op:    #0000ff40;
                        --UI-icon-green:      #20ae20  ;
                        --UI-icon-green-op:   #20ae2040;
                        --UI-icon-red:        #ff0000  ;
                        --UI-icon-red-op:     #ff000040;
                        --UI-icon-yellow:     #d29d08  ;
                        --UI-icon-yellow-op:  #d29d0840;
                        --UI-icon-violet:     #b21eb2  ;
                        --UI-icon-violet-op:  #b21eb240;
                        --UI-icon-breeze:     #14a1a1  ;
                        --UI-icon-breeze-op:  #14a1a140;
                        --UI-icon-dark:       #000000  ;
                        --UI-icon-dark-op:    #00000040;
                    `,
                    UIdark: `
                        --back-page:          #000000  ;
                        --text-color:         #f4f4f4  ;
                        --text-color-active:  #eeeeee  ;
                        --bg-color:           var(--back-page);
                        --bg-modal-color:     #101010${NOBLUR ? '' : 'cc'};
                        --con-color:          #151515${NOBLUR ? '' : 'cc'};
                        --con-color-hover:    #202020${NOBLUR ? '' : 'cc'};
                        --con-color-active:   #252525${NOBLUR ? '' : 'cc'};
                        --con-alt-color:      #303030cc;
                        --line-general-color: #60606040;
                        --icon-color:         #70707040;

                        --UI-icon-neutral:    #ffffff  ;
                        --UI-icon-neutral-op: #ffffff40;
                        --UI-icon-blue:       #0000ff  ;
                        --UI-icon-blue-op:    #0000ff40;
                        --UI-icon-green:      #00ff00  ;
                        --UI-icon-green-op:   #00ff0040;
                        --UI-icon-red:        #ff0000  ;
                        --UI-icon-red-op:     #ff000040;
                        --UI-icon-yellow:     #ffff00  ;
                        --UI-icon-yellow-op:  #ffff0040;
                        --UI-icon-violet:     #ff00ff  ;
                        --UI-icon-violet-op:  #ff00ff40;
                        --UI-icon-breeze:     #00ffff  ;
                        --UI-icon-breeze-op:  #00ffff40;
                        --UI-icon-dark:       #909090  ;
                        --UI-icon-dark-op:    #90909040;
                    `,
                    get: async (noHead) => {
                        if (localStorage.getItem('themeType') == 'season') UISEDT = SEASON
                        if (localStorage.getItem('themeType') == 'time') UISEDT = DAYTIMER
                        if (localStorage.getItem('themeType') == 'season') {
                            plutonny.output('id', 'theming', `
                            @media (prefers-color-scheme: light) { 
                                :root { ${UX.theme.UIlight} }
                            }
                            @media (prefers-color-scheme: dark) { 
                                :root { ${UX.theme.UIdark} }
                            }
                            .page {
                                background: radial-gradient(71.06% 29.13% at 131.07% 70.87%, var(--UI-${SEASON}) 0%, rgba(0, 0, 0, 0) 100%), radial-gradient(87.62% 39.56% at -37.62% 39.56%, var(--UI-${SEASON}) 0%, rgba(0, 0, 0, 0) 100%), var(--back-page);
                            }
                            `)
                            if (!noHead) document.getElementById("theme-color").content = window.matchMedia("(prefers-color-scheme: dark)").matches ? "#000000" : "#f4f4f4"
                        }
                        else if (localStorage.getItem('themeType') == 'time') {
                            plutonny.output('id', 'theming', `
                            :root { ${['night', 'sunset'].includes(DAYTIMER) ? UX.theme.UIdark : UX.theme.UIlight} }
                            html, body { background: var(--UI-${DAYTIMER}-b); }
                            .page {
                                background: radial-gradient(71.06% 29.13% at 131.07% 70.87%, var(--UI-${DAYTIMER}) 0%, rgba(0, 0, 0, 0) 100%), radial-gradient(87.62% 39.56% at -37.62% 39.56%, var(--UI-${DAYTIMER}) 0%, rgba(0, 0, 0, 0) 100%), var(--UI-${DAYTIMER}-b);
                            }
                            `)
                            await plutonny.sleep(100)
                            if (!noHead) document.getElementById("theme-color").content = window.getComputedStyle(document.body).getPropertyValue(`--UI-${DAYTIMER}-b`)
                        } else {
                            plutonny.console.error('UX.theme.get()', 'theme type is indefined')
                        }
                        if (plutonny.isMobile()) plutonny.output('id add', 'theming', `
                            * { cursor: default !important; }
                            :root { --con-color-hover: var(--con-color) !important; }
                        `)
                    },
                    modalColor: () => {
                        // for background color modal: #00000040
                        if (localStorage.getItem('themeType') == 'season') {
                            return window.matchMedia("(prefers-color-scheme: dark)").matches ? "#000000" : "#b8b8b8"
                        }
                        else if (localStorage.getItem('themeType') == 'time') {
                            if (DAYTIMER == 'night') return '#000000'
                            if (DAYTIMER == 'sunrise') return '#659cad'
                            if (DAYTIMER == 'day') return '#b8b8b8'
                            if (DAYTIMER == 'evening') return '#659cad'
                            if (DAYTIMER == 'sunset') return '#4c0c36'
                        } else {
                            plutonny.console.error('UX.theme.modalColor()', 'theme type is indefined')
                        }
                    }
                },
                modal: async (type, content) => {
                    UX.theme.get(true)
                    if (type == 'dialog') {
                        try {
                            plutonny.output('id', 'modal', `
                                <div class="max-modal" id="max-modal">
                                    <style>
                                        div#modal { top: 100%; position: fixed; height: 100vh; width: 100vw; display: flex; justify-content: center; align-items: flex-end; z-index: 100; }
                                        div#max-modal { width: 100%; padding: 24px; }
                                    </style>
                                    ${content}
                                </div>
                            `)
                            await plutonny.sleep(200)
                            // document.getElementById("theme-color").content = UX.theme.modalColor()
                            plutonny.output('id', 'modalWork', `
                                div#modal { top: 0% !important; }
                            `)
                            await plutonny.sleep(200)
                            plutonny.output('id', 'modalWork2', `
                                div#full-max-modal, div#page { filter: blur(5px); --webkit-filter: blur(5px); }
                            `)
                            await plutonny.sleep(200)
                            if (document.getElementById('modal').innerHTML == '') UX.modal('dialog', content)
                            return true
                        } catch (e) {
                            plutonny.console.error('UX.modal(dialog)', e)
                            return false
                        }
                    }
                    else if (type == 'fullscreen') {
                        try {
                            plutonny.output('id', 'full-modal', `
                                <div class="full-max-modal" id="full-max-modal">
                                    <style>
                                        div#full-modal { top: 100%; position: fixed; height: 100vh; width: 100vw; display: flex; justify-content: center; align-items: flex-end; z-index: 99; }
                                        div#full-max-modal { width: 100%; height: calc(100vh - 32px); overflow-y: auto; background: var(--bg-modal-color); ${NOBLUR ? '' : 'backdrop-filter: blur(30px); --webkit-backdrop-filter: blur(30px);'} border-radius: 24px 24px 0 0; }
                                    </style>
                                    <div style="margin: 18px; display: flex; justify-content: flex-end;">
                                        <p onclick="UX.closeModal('fullscreen')" style="cursor: pointer;" class="bold">закрыть</p>
                                    </div>
                                    <hr style="border: none; height: 1px; margin-top: 0; margin-bottom: 0; background-color: var(--con-alt-color); width: 100%;">
                                    ${content}
                                </div>
                            `)
                            await plutonny.sleep(200)
                            plutonny.output('id', 'fullModalWork', `
                                div#full-modal { top: 0% !important; }
                            `) 
                            await plutonny.sleep(200)
                            plutonny.output('id', 'fullModalWork2', `
                                html, body { background: #000000; }
                                .page {
                                    margin-top: 16px;
                                    margin-left: 16px;
                                    margin-right: 16px;
                                    border-top-left-radius: 18px;
                                    border-top-right-radius: 18px;
                                    position: fixed;
                                }
                                @media (max-width: 540px) {
                                    .page { width: calc(100vw - 36px) !important; }
                                }
                                @media (min-width: 541px) {
                                    .page { width: 404px !important; }
                                }
                            `) 
                            await plutonny.sleep(200)
                            document.getElementById('theme-color').content = '#000000'
                            if (document.getElementById('full-modal').innerHTML == '') UX.modal('fullscreen', content)
                            return true
                        } catch (e) {
                            plutonny.console.error('UX.modal(fullscreen)', e)
                            return false
                        }
                    }
                    else plutonny.console.error('UX.modal()', 'incorrect type of modal')
                },
                closeModal: async (type) => {
                    if (type == 'dialog') {
                        document.getElementById('modalWork2').innerHTML = '';
                        await plutonny.sleep(200);
                        document.getElementById('modalWork').innerHTML = '';
                        await plutonny.sleep(400);
                        document.getElementById('modal').innerHTML = '';
                    } 
                    else if (type == 'fullscreen') {
                        document.getElementById('fullModalWork2').innerHTML = '';
                        await plutonny.sleep(100);
                        UX.theme.get(false)
                        await plutonny.sleep(100);
                        document.getElementById('fullModalWork').innerHTML = '';
                        clearInterval(ND)
                        clearInterval(CE)
                        clearInterval(GP)
                        clearInterval(AW)
                        clearInterval(AD)
                        clearInterval(AH)
                        clearInterval(AM)
                        clearInterval(AS)
                        await plutonny.sleep(400);
                        document.getElementById('full-modal').innerHTML = '';
                        
                    }
                    else plutonny.console.error('index.html -> UX.closeModal()', 'incorrect type of modal')
                },
                openInfo: () => {
                    if (document.getElementById('countInfo').style.height == '40px') {
                        document.getElementById('countInfo').style.height = '118px'
                        document.getElementById('countInfoRotate').style.transform = 'rotate(180deg)'
                    }
                    else {
                        document.getElementById('countInfo').style.height = '40px'
                        document.getElementById('countInfoRotate').style.transform = 'rotate(0deg)'
                    }
                },
                startEvent: async (start, end, process) => {
                    try {
                        COUNT.general.percents(start, end, process); await plutonny.sleep(50)
                        COUNT.general.week(start, end); await plutonny.sleep(50)
                        COUNT.general.day(start, end); await plutonny.sleep(50)
                        COUNT.general.hour(start, end); await plutonny.sleep(50)
                        COUNT.general.minute(start, end); await plutonny.sleep(50)
                        COUNT.general.second(start, end)
                    } catch (e) {
                        plutonny.console.error('UX.startEvent() -> f', e)
                    }

                    try {
                        GP = setInterval(() => { COUNT.general.percents(start, end, process) }, 100)
                        AW = setInterval(() => { COUNT.general.week(start, end) }, 1000)
                        AD = setInterval(() => { COUNT.general.day(start, end) }, 1000)
                        AH = setInterval(() => { COUNT.general.hour(start, end) }, 1000)
                        AM = setInterval(() => { COUNT.general.minute(start, end) }, 300)
                        AS = setInterval(() => { COUNT.general.second(start, end) }, 50)
                    } catch (e) {
                        plutonny.console.error('UX.startEvent() -> s', e)
                    }
                },
                endEvent: async (endText) => {
                    await plutonny.sleep(1100)

                    clearInterval(ND)
                    clearInterval(CE)
                    clearInterval(GP)
                    clearInterval(AW)
                    clearInterval(AD)
                    clearInterval(AH)
                    clearInterval(AM)
                    clearInterval(AS)

                    document.getElementById('countGenLine').style.width = '100%'
                    document.getElementById('countGenPer').innerHTML = '100 %'
                    document.getElementById('countGenText').innerHTML = '<p style="margin: 18px 0 0 0; font-size: 14px; position: absolute;">0&nbsp;дней,&nbsp;0&nbsp;часов,&nbsp;0&nbsp;минут,&nbsp;0&nbsp;секунд</p>'
                    document.getElementById('countAddCon').innerHTML = `
                    <div style="display: flex; align-items: center; flex-direction: column; justify-content: center; height: 100%;">
                        <img src="/static/emoji/endEvent.png" style="height: 120px; width: 120px;">
                        <div style="height: 24px;"></div>
                        <p class="bold" style="font-size: 24px; text-align: center;">${endText}</p>
                    </div>
                    `
                }
            }
            UX.theme.get(false)
        </script>

        <!-- UI -->
        <script type="text/javascript">
            var UIelements = 0
            var UI = {
                event: (size, event, id) => {
                    UIelements++
                    switch(size) {
                        case 'small':
                            let dd1s, dd2s, ddny, inj
                            if (event.type == 'once') {
                                dd1s = new Date(event.Edate.split('-')[0], event.Edate.split('-')[1] - 1, event.Edate.split('-')[2], event.Etime.split(':')[0], event.Etime.split(':')[1])
                                inj = COUNT.fastDay(DYNAMICTIME, dd1s)
                            } else {
                                dd2s = UX.dateThisYear(event.date, event.time)
                                ddny = new Date(dd2s.getFullYear() + 1, dd2s.getMonth(), dd2s.getDate(), dd2s.getHours(), dd2s.getMinutes())
                                inj = dd2s > DYNAMICTIME ? COUNT.fastDay(DYNAMICTIME, dd2s) : COUNT.fastDay(DYNAMICTIME, ddny)
                            }
                            return `<div id="UIelement${UIelements}" style="display: flex; flex-direction: row; flex-wrap: nowrap; align-items: center; opacity: 0;">
                                <div style="height: 36px; width: 36px;">
                                    ${plutonny.UI.gIcon({
                                        size: 36,
                                        border: 100,
                                        color: event.color,
                                        icon: event.icon,
                                        font: 24
                                    })}
                                </div>
                                <div style="width: 12px;"></div>
                                <p style="font-size: 15px; margin: 0;">${event.nameText} <small style="font-size: 12px; margin: 0;">(${inj}&nbsp;дн.)</small></p>
                                </div>`
                        case 'large':
                            let dd1l, dd2l
                            if (event.type == 'once') {
                                dd1l = new Date(event.Sdate.split('-')[0], event.Sdate.split('-')[1] - 1, event.Sdate.split('-')[2], event.Stime.split(':')[0], event.Stime.split(':')[1])
                                dd2l = new Date(event.Edate.split('-')[0], event.Edate.split('-')[1] - 1, event.Edate.split('-')[2], event.Etime.split(':')[0], event.Etime.split(':')[1])
                            } else {
                                [dd1l, dd2l] = UX.datePrepare(UX.dateThisYear(event.date, event.time))
                            }
                            return `
                            <div id="UIelement${UIelements}" onclick="UI.modal.counter(${id})" class="conHA" style="opacity: 0;">
                                <div style="height: 42px; width: 42px;">
                                    ${plutonny.UI.gIcon({
                                        size: 42,
                                        border: 100,
                                        color: event.color,
                                        icon: event.icon,
                                        font: 28
                                    })}
                                </div>
                                <div style="width: 16px;"></div>
                                <p style="font-size: 16px; margin: 0;">${event.nameText}</p>
                                <div style="margin-right: auto;"></div>
                                <p style="font-size: 24px; margin: 0 0 0 8px;">${COUNT.fastPer(dd1l, dd2l, event.type)}</p>
                            </div>`
                    }
                },
                modal: {
                    settings: () => {
                        UX.modal('fullscreen', `
                        <style>
                         .full-max-modal { padding: 0 24px !important; }
                        </style>
                        <div style="height: 28px;"></div>
                        <p style="font-size: 32px; margin-left: 18px;" class="bold">цвета:</p>
                        <div style="height: 24px;"></div>
                        <div style="display: flex;">
                            <button onclick="localStorage.setItem('themeType', 'season'); document.getElementById('chaBut1').style.border = '2px solid var(--con-alt-color)'; document.getElementById('chaBut2').style.border = 'none'; UX.theme.get(true); document.getElementById('theme-color').content = '#000000';" id="chaBut1" style="${localStorage.getItem('themeType') == 'season' ? 'border: 2px solid var(--con-alt-color); ' : ''} display: flex; flex-direction: column; align-items: center; justify-content: space-evenly; height: 220px; width: 50%;">
                                <span class="material-symbols-rounded icoGo" style="font-size: 80px !important; user-select: none;">calendar_today</span>
                                <p style="text-align: center;">по времени года</p>
                            </button>
                            <div style="width: 24px;"></div>
                            <button onclick="localStorage.setItem('themeType', 'time'); document.getElementById('chaBut1').style.border = 'none'; document.getElementById('chaBut2').style.border = '2px solid var(--con-alt-color)'; UX.theme.get(true); document.getElementById('theme-color').content = '#000000';" id="chaBut2" style="${localStorage.getItem('themeType') == 'time' ? 'border: 2px solid var(--con-alt-color); ' : ''} display: flex; flex-direction: column; align-items: center; justify-content: space-evenly; height: 220px; width: 50%;">
                                <span class="material-symbols-rounded icoGo" style="font-size: 80px !important; user-select: none;">schedule</span>
                                <p style="text-align: center;">по времени суток</p>
                            </button>
                        </div>
                        <div style="height: 24px;"></div>
                        <div style="display: flex; flex-direction: column; border-radius: 24px; overflow: hidden;">
                            <button onclick="dataSet.cache()" id="CCB" style="border-radius: 8px;">очистить кэш</button>
                            <div style="height: 4px;"></div>
                            <button onclick="dataSet.clearModal()" style="border-radius: 8px;">удалить все данные</button>
                        </div>
                        <div style="height: 24px;"></div>
                        <p style="text-align: center;" class="bold">v${siteVersion} (${siteBuild})</p>
                        `)
                    },
                    counter: async (id) => {
                        let event = JSON.parse(sessionStorage.getItem(`id${id}`))
                        let dataInfo = ''
                        if (event.type == 'dayInYear') {
                            let dd1 = UX.dateThisYear(event.date, event.time)
                            dataInfo += `
                            раз в год: ${event.date.split('-')[1]} ${monthList[event.date.split('-')[0] - 1]}<br>
                            отмечается уже ${plutonny.UI.rus('year', (DYNAMICTIME.getFullYear() - event.startFrom - ((dd1 > DYNAMICTIME) ? 1 : 0)))} (с ${event.startFrom})
                            `
                        }
                        if (event.type == 'timeInYear') {
                            let dd2 = UX.dateThisYear(event.date, event.time)
                            dataInfo += `
                            раз в год: ${event.date.split('-')[1]} ${monthList[event.date.split('-')[0] - 1]}, ${event.time}<br>
                            отмечается уже ${plutonny.UI.rus('year', (DYNAMICTIME.getFullYear() - event.startFrom - ((dd2 > DYNAMICTIME) ? 1 : 0)))} (с ${event.startFrom})
                            `
                        }
                        if (event.type == 'once') {
                            dataInfo += `
                            период с ${event.Stime} ${event.Sdate.split('-')[2]} ${monthList[event.Sdate.split('-')[1] - 1]} ${event.Sdate.split('-')[0]} по ${event.Etime} ${event.Edate.split('-')[2]} ${monthList[event.Edate.split('-')[1] - 1]} ${event.Edate.split('-')[0]}<br>
                            `
                        }
                        
                        UX.modal('fullscreen', `
                        <style>
                         .full-max-modal { padding: 0 24px !important; }
                        </style>
                        <div style="height: 28px;"></div>
                        <p style="font-size: 32px; padding-left: 18px;" class="bold">${event.processText}:</p>
                        <div style="height: 28px;"></div>
                        <div class="countGenCon">
                            <div class="countLine" id="countLine">
                                <div id="countGenLine" class="countGenLine" style="background: var(--line-${UISEDT}); border-radius: 100px; height: 100%; width: 0px;"></div>
                                <p id="countGenPer" class="countGenPer bold" style="position: absolute; font-size: 28px; text-align: center; margin: 0;"></p>
                            </div>
                            <div class="countGenText" id="countGenText">
                            </div>
                        </div>
                        <div style="height: 22px;"></div>
                        <p class="bold" style="font-size: 32px; padding-left: 18px;">или:</p>
                        <div style="height: 22px;"></div>
                        <div class="countAddCon" id="countAddCon">
                            <div class="weekBlock">
                                <div id="weekLine" class="weekLine" style="background: var(--line-${UISEDT});"></div>
                                <p id="weekPer" class="weekPer"></p>
                            </div>
                            <div style="height: 18px;"></div>
                            <div class="dayBlock">
                                <div id="dayLine" class="dayLine" style="background: var(--line-${UISEDT});"></div>
                                <p id="dayPer" class="dayPer"></p>
                            </div>
                            <div style="height: 18px;"></div>
                            <div class="hourBlock">
                                <div id="hourLine" class="hourLine" style="background: var(--line-${UISEDT});"></div>
                                <p id="hourPer" class="hourPer"></p>
                            </div>
                            <div style="height: 18px;"></div>
                            <div class="minuteBlock">
                                <div id="minuteLine" class="minuteLine" style="background: var(--line-${UISEDT});"></div>
                                <p id="minutePer" class="minutePer"></p>
                            </div>
                            <div style="height: 18px;"></div>
                            <div class="secondBlock">
                                <div id="secondLine" class="secondLine" style="background: var(--line-${UISEDT});"></div>
                                <p id="secondPer" class="secondPer"></p>
                            </div>
                        </div>
                        <div style="height: 28px;"></div>
                        <div class="countInfo" id="countInfo" style="height: 40px;">
                            <button onclick="UX.openInfo()" style="width: 100%; padding: 4px 18px; border-radius: 8px; display: flex; align-items: center; justify-content: space-between;">
                                <p>информация</p>
                                <span class="material-symbols-rounded icoGo clickable" id="countInfoRotate" style="font-size: 32px !important; transform: rotate(0deg);">expand_more</span>
                            </button>
                            <div style="height: 4px;"></div>
                            <div style="border-radius: 8px; background: var(--con-color);">
                                <p style="padding: 18px;">${dataInfo}</p>
                            </div>
                        </div>
                        <div style="height: 22px;"></div>
                        `)
                        
                        ND = setInterval(() => { DYNAMICTIME = new Date() }, 100)
                        await plutonny.sleep(500)

                        if (event.type == 'dayInYear') {
                            let [d1, d2] = UX.datePrepare(UX.dateThisYear(event.date, event.time))
                            if ((DYNAMICTIME.getMonth() == d1.getMonth()) && (DYNAMICTIME.getDate() == d1.getDate())) UX.endEvent(event.endText)
                            else {
                                CE = setInterval(() => {
                                    if ((DYNAMICTIME.getMonth() == d1.getMonth()) && (DYNAMICTIME.getDate() == d1.getDate())) UX.endEvent(event.endText)
                                }, 10)
                                UX.startEvent(d1, d2, event.processText)
                            }
                        }
                        if (event.type == 'timeInYear') {
                            let [d3, d4] = UX.datePrepare(UX.dateThisYear(event.date, event.time))
                            let d5 = UX.dateThisYear(event.date, event.time)
                            if ((DYNAMICTIME.getMonth() == d3.getMonth()) && (DYNAMICTIME.getDate() == d3.getDate()) && DYNAMICTIME >= d5) UX.endEvent(event.endText)
                            else {
                                CE = setInterval(() => {
                                    if ((DYNAMICTIME.getMonth() == d3.getMonth()) && (DYNAMICTIME.getDate() == d3.getDate()) && DYNAMICTIME >= d5) UX.endEvent(event.endText)
                                }, 10)
                                UX.startEvent(d3, d4, event.processText)
                            }
                        }
                        if (event.type == 'once') {
                            let d6 = new Date(event.Sdate.split('-')[0], event.Sdate.split('-')[1] - 1, event.Sdate.split('-')[2], event.Stime.split(':')[0], event.Stime.split(':')[1])
                            let d7 = new Date(event.Edate.split('-')[0], event.Edate.split('-')[1] - 1, event.Edate.split('-')[2], event.Etime.split(':')[0], event.Etime.split(':')[1])
                            if (DYNAMICTIME >= d7) UX.endEvent(event.endText)
                            else {
                                CE = setInterval(() => {
                                    if (DYNAMICTIME >= d7) UX.endEvent(event.endText)
                                }, 10)
                                UX.startEvent(d6, d7, event.processText)
                            }
                        }
                    }
                }
            }
        </script>

        <!-- counters -->
        <script type="text/javascript">
            var COUNT = {
                fastPer: (START, END, typeEvent) => {
                    if (typeEvent == 'dayInYear' || typeEvent == 'timeInYear') {
                        if ((DYNAMICTIME.getMonth() == START.getMonth()) && (DYNAMICTIME.getDate() == START.getDate())) {
                            return '100&nbsp;%'
                        }
                    }
                    let p = (START - DYNAMICTIME) / (START - END) * 100
                    return `${(parseFloat(parseInt(p * 10)) % 10) > 7 ? parseInt(p + 1) : parseInt(p)}&nbsp;%`
                },
                fastDay: (START, END) => {
                    return Math.floor(((END - START) / 1000 / 60 / 60 / 24)) + 1
                },
                general: {
                    percents: (START, END, textPROCESS) => {
                        let p = END - DYNAMICTIME
                        if (p > 0) {
                            let r   = (END - DYNAMICTIME) / 1000

                            let rd  = Math.floor(r / 60 / 60 / 24)
                                r  -=            rd * 60 * 60 * 24
                            let rh  = Math.floor(r / 60 / 60)
                                r  -=            rh * 60 * 60
                            let rm  = Math.floor(r / 60)
                                r  -=            rm * 60
                            let rs  = Math.floor(r)

                            try {
                                document.querySelector('#countGenText').innerHTML = `
                                <p style="margin: 18px 0 0 0; font-size: 14px; position: absolute;">
                                    ${plutonny.UI.rus('day', rd)},&nbsp;${plutonny.UI.rus('hour', rh)},&nbsp;${plutonny.UI.rus('minute', rm)},&nbsp;${plutonny.UI.rus('second', rs)}
                                </p>`
                            } catch {
                                UX.closeModal('fullscreen')
                            }
                            
                            let pd100 = (START - DYNAMICTIME) / (START - END) * 100
                            let pm100 = parseFloat(parseInt((pd100 * 1000) + 1)) / 1000

                            document.querySelector('#countGenPer').innerHTML = `${pm100} %`
                            document.querySelector('#countGenLine').style.width = `${(((document.body.clientWidth >= 540 ? 440 : document.body.clientWidth) - 36 - 48) / 100) * pm100}px`
                        }
                    },
                    week: (START, END) => {
                        let p = END - DYNAMICTIME
                        if (p > 0) {
                            let r   = (END - DYNAMICTIME) / 1000

                            let cmn = new Date(DYNAMICTIME.getFullYear(), DYNAMICTIME.getMonth() + 1, END.getDate(), END.getHours(), END.getMinutes(), END.getSeconds())
                            let smn = new Date(DYNAMICTIME.getFullYear(), DYNAMICTIME.getMonth(), END.getDate(), END.getHours(), END.getMinutes(), END.getSeconds())
                            let rmm = (cmn - DYNAMICTIME) / (cmn - smn)

                            let rw  = Math.floor((r / 60 / 60 / 24 / 7) * 100) / 100
                            document.querySelector('#weekPer').innerHTML = plutonny.UI.rus('week', rw)
                            document.querySelector('#weekLine').style.width = `${(((document.body.clientWidth >= 540 ? 440 : document.body.clientWidth) - 36 - 48) / 100) * Math.floor((rmm % 1)*100)}px`
                            document.querySelector('#dayLine').style.width = `${(((document.body.clientWidth >= 540 ? 440 : document.body.clientWidth) - 36 - 48) / 100) * Math.floor((rw % 1)*100)}px`
                        }
                    },
                    day: (START, END) => {
                        let p = END - DYNAMICTIME
                        if (p > 0) {
                            let r   = (END - DYNAMICTIME) / 1000

                            let rd  = Math.floor((r / 60 / 60 / 24) * 100) / 100
                            document.querySelector('#dayPer').innerHTML = plutonny.UI.rus('day', rd)
                            document.querySelector('#hourLine').style.width = `${(((document.body.clientWidth >= 540 ? 440 : document.body.clientWidth) - 36 - 48) / 100) * Math.floor((rd % 1)*100)}px`
                        }

                    },
                    hour: (START, END) => {
                        let p = END - DYNAMICTIME
                        if (p > 0) {
                            let r   = (END - DYNAMICTIME) / 1000

                            let rh  = Math.floor((r / 60 / 60) * 100) / 100
                            document.querySelector('#hourPer').innerHTML = plutonny.UI.rus('hour', rh)
                            document.querySelector('#minuteLine').style.width = `${(((document.body.clientWidth >= 540 ? 440 : document.body.clientWidth) - 36 - 48) / 100) * Math.floor((rh % 1)*100)}px`
                        }

                    },
                    minute: (START, END) => {
                        let p = END - DYNAMICTIME
                        if (p > 0) {
                            let r   = (END - DYNAMICTIME) / 1000

                            let rm  = Math.floor((r / 60) * 100) / 100
                            document.querySelector('#minutePer').innerHTML = plutonny.UI.rus('minute', rm)
                            document.querySelector('#secondLine').style.width = `${(((document.body.clientWidth >= 540 ? 440 : document.body.clientWidth) - 36 - 48) / 100) * Math.floor((rm % 1)*100)}px`
                        }

                    },
                    second: (START, END) => {
                        let p = END - DYNAMICTIME
                        if (p > 0) {
                            let r   = (END - DYNAMICTIME) / 1000

                            let rs  = Math.floor((r) * 10) / 10
                            document.querySelector('#secondPer').innerHTML = plutonny.UI.rus('second', rs)
                        }

                    }
                }
            }
        </script>

        <!-- serviceWorker -->
        <script type="text/javascript">
            if ('serviceWorker' in navigator) { 
                window.addEventListener('load', () => {
                    navigator.serviceWorker.register('/service-worker.js').then(
                        (registration) => { console.log(`serviceWorker: registration with scope ${registration.scope}`) },
                        (e) => { plutonny.console.error('serviceWorker module', `serviceWorker registration failed: ${e}`) }
                    ).catch((e) => { plutonny.console.error('serviceWorker module', `serviceWorker function (${e})`) })
                })
            } else plutonny.console.warn('serviceWorker module', 'service worker is not supported')
        </script>
    </head>
    <body>

        <noscript style="color: white; font-size: 36px;">включите JavaScript чтобы пользоваться сайтом</noscript>

        <div class="modal" id="modal"></div>
        <div class="full-modal" id="full-modal"></div>

        <div class="pageble" id="pageble">
            <div class="page" id="page">
                <div class="header" id="header">
                    <div class="hdr">
                        <div style="width: 46px;"></div>
                        <p style="text-align: center; font-size: 32px; margin: 0; z-index: 10;" class="bold" onclick="plutonny.get.eruda()">my cat</p>
                        <div style="width: 8px;"></div>
                        <img src="static/emoji/headerLogo.png" height="32px" width="32px">
                        <div style="margin-right: auto;"></div>
                        <span onclick="UI.modal.settings()" class="material-symbols-rounded icoGo clickable" style="font-size: 32px !important;">settings</span>
                        <div style="width: 46px;"></div>
                    </div>
                    <hr style="border: none; height: 1px; margin-top: 0; margin-bottom: 0; background-color: var(--con-alt-color); width: calc(100% - 48px);">
                </div>
                <div class="content" id="content">
                    <div class="blockGeneral" id="blockGeneral">
                        <div class="lineGeneral" id="lineGeneral">
                            <div id="yearLine" style="position: absolute; background: var(--con-color); height: 60px; padding: 0 3px; margin-top: -6px;">
                                <div style="background: var(--text-color); height: 60px; width: 4px; border-radius: 100px;"></div>
                            </div>
                        </div>
                        <script type="text/javascript">
                            window.addEventListener('load', () => {
                                document.getElementById('lineGeneral').style.opacity = 1
                                let j1 = new Date(DYNAMICTIME.getFullYear(), 0, 1), d3 = new Date(DYNAMICTIME.getFullYear(), 11, 31, 23, 59, 59)
                                let yearP = 0
                                if (document.documentElement.clientWidth <= 540)
                                    yearP = (document.documentElement.clientWidth - 94) * ((j1 - DYNAMICTIME) / (j1 - d3))
                                else 
                                    yearP = ((440 - 94) * ((j1 - DYNAMICTIME) / (j1 - d3)))
                                document.getElementById('yearLine').style.marginLeft = `${yearP}px`
                            })
                        </script>
                        <div class="textGeneral" id="textGeneral">
                            <p class="bold" style="font-size: 20px; margin: 18px 0 12px 0;">ближайшее событие:</p>
                        </div>
                    </div>
                    <div style="height: 24px;"></div>
                    <p class="bold" style="font-size: 32px; margin: 0; padding-left: 18px;">все события:</p>
                    <div style="height: 24px;"></div>
                    <div class="countersContainer" id="countersContainer"></div>
                </div>
            </div>
        </div>

        <!-- create home page -->
        <script type="text/javascript">
            fetch(`/DBCOUNT.json?t=${DYNAMICTIME.getTime()}`).then((response) => { return response.json() }).then(async (fileCounters) => {
                let datesTSort = []
                for (let i = 1; i <= fileCounters.count; i++) {
                    let WRdata
                    if (fileCounters[i].type == 'once') WRdata = new Date(`${fileCounters[i].Edate} ${fileCounters[i].Etime}`)
                    else                                WRdata = new Date(`${DYNAMICTIME.getFullYear()}-${fileCounters[i].date}`)
                    if ((WRdata - DYNAMICTIME) > 0)     datesTSort.push([i, WRdata.getTime()])
                }
                if (datesTSort.length == 0) {
                    for (let i = 1; i <= fileCounters.count; i++) {
                        let WRdata
                        if (fileCounters[i].type == 'once') WRdata = new Date(`${fileCounters[i].Edate} ${fileCounters[i].Etime}`)
                        else                                WRdata = new Date(`${DYNAMICTIME.getFullYear() + 1}-${fileCounters[i].date}`)
                        datesTSort.push([i, WRdata.getTime()])
                    } 
                }
                let fastest = datesTSort.sort((a, b) => { return a[1] > b[1] })[0][0]
                plutonny.output('id add', 'textGeneral', UI.event('small', fileCounters[fastest]))
                await plutonny.sleep(10)
                document.getElementById(`UIelement${UIelements}`).style.opacity = 1
                await plutonny.sleep(50)
                sessionStorage.setItem(`countCounters`, fileCounters.count)
                for (let i = 1; i <= fileCounters.count; i++) {
                    sessionStorage.setItem(`id${i}`, JSON.stringify(fileCounters[i]))
                    let OUdata
                    if (fileCounters[i].type == 'once') { 
                        OUdata = new Date(`${fileCounters[i].Edate} ${fileCounters[i].Etime}`)
                        if (DYNAMICTIME <= OUdata) plutonny.output('id add', 'countersContainer', `${UI.event('large', fileCounters[i], i)}${i == fileCounters.count ? '' : '<div style="height: 8px;"></div>'}`)
                    }
                    else plutonny.output('id add', 'countersContainer', `${UI.event('large', fileCounters[i], i)}${i == fileCounters.count ? '' : '<div style="height: 8px;"></div>'}`)
                    await plutonny.sleep(50)
                    document.getElementById(`UIelement${UIelements}`).style.opacity = 1
                }
            }).catch(async (err) => { 
                plutonny.console.error('index.html -> create home page -> JSON (DBCOUNT)', err) 
                try {
                    let SScount = sessionStorage.getItem('countCounters')
                    let SScounters = []
                    for (let i = 1; i <= SScount; i++) SScounters.push(JSON.parse(sessionStorage.getItem(`id${i}`)))
                    let datesTSort2 = []
                    for (let i = 0; i < SScount; i++) {
                        let WRdata2
                        if (SScounters[i].type == 'once') WRdata2 = new Date(`${SScounters[i].Edate} ${SScounters[i].Etime}`)
                        else                              WRdata2 = new Date(`${DYNAMICTIME.getFullYear()}-${SScounters[i].date}`)
                        if ((WRdata2 - DYNAMICTIME) > 0)  datesTSort2.push([i, WRdata2.getTime()])
                    }
                    if (datesTSort2.length == 0) {
                        for (let i = 0; i < SScount; i++) {
                            let WRdata2
                            if (SScounters[i].type == 'once') WRdata2 = new Date(`${SScounters[i].Edate} ${SScounters[i].Etime}`)
                            else                              WRdata2 = new Date(`${DYNAMICTIME.getFullYear() + 1}-${SScounters[i].date}`)
                            datesTSort2.push([i, WRdata2.getTime()])
                        } 
                    }
                    let fastest2 = datesTSort2.sort((a, b) => { return a[1] > b[1] })[0][0]
                    plutonny.output('id add', 'textGeneral', UI.event('small', SScounters[fastest2]))
                    await plutonny.sleep(10)
                    document.getElementById(`UIelement${UIelements}`).style.opacity = 1
                    await plutonny.sleep(50)
                    for (let i = 0; i < SScount; i++) {
                        let OUdata2
                        if (SScounters[i].type == 'once') { 
                            OUdata2 = new Date(`${SScounters[i].Edate} ${SScounters[i].Etime}`)
                            if (DYNAMICTIME <= OUdata2) plutonny.output('id add', 'countersContainer', `${UI.event('large', SScounters[i], i)}${i == SScount - 1 ? '' : '<div style="height: 8px;"></div>'}`)
                        }
                        else plutonny.output('id add', 'countersContainer', `${UI.event('large', SScounters[i], i)}${i == SScount - 1 ? '' : '<div style="height: 8px;"></div>'}`)
                        await plutonny.sleep(50)
                        document.getElementById(`UIelement${UIelements}`).style.opacity = 1
                    }
                } catch (e) {
                    plutonny.console.error('index.html -> create home page -> alternative', e)
                }
            })
        </script>

        <!-- settings functions -->
        <script type="text/javascript">
            var dataSet = {
                cache: () => {
                    caches.delete('v3-mycat-byPlutonny')
                    caches.delete('mycat-byPlutonny')
                    plutonny.output('id', 'CCB', 'успешно')
                },
                clearModal: () => {
                    UX.modal('dialog', `
                        <div style="width: 100%; background: var(--con-color); border-radius: 24px;">
                            <div style="height: 18px;"></div>
                            <h2 class="bold" style="text-align: center;">уверены в своем решении?</h2>
                            <div style="height: 24px;"></div>
                            <p style="padding: 0 18px;">удаление всех данных приведет к:</p>
                            <div style="height: 18px;"></div>
                            <li style="padding: 0 24px;">удалению кеша сайта</li>
                            <div style="height: 12px;"></div>
                            <li style="padding: 0 24px;">сбросу настроек темы (установятся по умолчанию: по времени года)</li>
                            <div style="height: 18px;"></div>
                        </div>
                        <div style="height: 24px;"></div>
                        <div style="width: 100%; border-radius: 24px; display: flex;flex-direction: column; border-radius: 24px; overflow: hidden;">
                            <button style="background: var(--con-color); height: 52px; border-radius: 8px; color: #ff0000;" class="bold" onclick="dataSet.clear()">УДАЛИТЬ</button>
                            <div style="height: 4px;"></div>
                            <button style="background: var(--con-color); height: 52px; border-radius: 8px;" onclick="UX.closeModal('dialog')">отмена</button>
                        </div>
                    `)
                },
                clear: async () => {
                    try {
                        navigator.serviceWorker.getRegistrations().then((registrations) => {
                            for(let registration of registrations) {
                                registration.unregister();
                            } 
                        });
                        caches.delete('v3-mycat-byPlutonny')
                        caches.delete('mycat-byPlutonny')
                        localStorage.clear()
                        sessionStorage.clear()
                    }
                    catch (e) { plutonny.console.error('index.html -> dataSet.clear()', e) }
                    UX.closeModal('dialog')
                    await plutonny.sleep(700)
                    UX.modal('dialog', `
                    <div style="width: 100%; background: var(--con-color); border-radius: 24px;">
                        <div style="height: 18px;"></div>
                        <h2 class="bold" style="text-align: center;">успешно!</h2>
                        <div style="height: 24px;"></div>
                        <p style="padding: 0 18px;">теперь нужно перезагрузить страницу</p>
                        <div style="height: 18px;"></div>
                    </div>
                    <div style="height: 24px;"></div>
                    <div style="width: 100%; border-radius: 24px; display: flex;flex-direction: column; border-radius: 24px; overflow: hidden;">
                        <button style="background: var(--con-color); height: 52px; border-radius: 0px;" onclick="location.reload()">перезагрузить</button>
                    </div>
                    `)
                }
            }
        </script>
        
    </body>
</html>